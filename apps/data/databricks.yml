bundle:
  name: open-jii

# Workspace configuration
workspace:
  # Root path where bundle artifacts will be deployed
  root_path: /Workspace/Shared/.bundle/${bundle.name}/${bundle.target}
  # File path for deployed notebooks
  file_path: /Workspace/Shared/.bundle/${bundle.name}/${bundle.target}/notebooks
  # Artifact path for wheels
  artifact_path: /Workspace/Shared/.bundle/${bundle.name}/${bundle.target}/artifacts

# Permissions - allow all users to read deployed resources
permissions:
  - level: CAN_MANAGE
    group_name: users

# Artifacts configuration - Python wheels for custom libraries
artifacts:
  ambyte_wheel:
    type: whl
    path: ./src/lib/ambyte
    build: python3 -m build

  enrich_wheel:
    type: whl
    path: ./src/lib/enrich
    build: python3 -m build

  multispeq_wheel:
    type: whl
    path: ./src/lib/multispeq
    build: python3 -m build

  openjii_wheel:
    type: whl
    path: ./src/lib/openjii
    build: python3 -m build

# Sync configuration for notebooks
sync:
  # Only sync notebooks, pipelines, and tasks - exclude everything else
  include:
    - "src/pipelines/**"
    - "src/tasks/**"
    - "src/notebooks/**"
  
  # Patterns to exclude
  exclude:
    - ".DS_Store"
    - "lib/**"               # Libraries are deployed as wheels
    - "*.json"               # package.json, tsconfig.json, etc.
    - "*.toml"               # pyproject.toml
    - "*.md"                 # README.md
    - "*.yml"                # databricks.yml
    - "*.yaml"               # Any YAML files
    - "*.lock"               # Lock files
    - ".gitignore"
    - "src/lib/**"           # Library source code (deployed as wheels)

# Deployment targets
targets:
  # Development environment
  dev:
    mode: production
    default: true

  # Production environment
  prod:
    mode: production
